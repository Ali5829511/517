# Apache Virtual Host Configuration for Housing Management System
# إعدادات Apache Virtual Host لنظام إدارة الإسكان الجامعي
#
# This file provides sample Apache configuration for deploying the Housing Management System
# يوفر هذا الملف نموذج تكوين Apache لنشر نظام إدارة الإسكان الجامعي
#
# INSTALLATION INSTRUCTIONS / تعليمات التثبيت:
# ==========================================
#
# Windows XAMPP:
# 1. Copy this configuration to: C:\xampp\apache\conf\extra\httpd-vhosts.conf
#    OR add it to the end of: C:\xampp\apache\conf\httpd.conf
# 2. Edit the paths to match your installation
# 3. Restart Apache from XAMPP Control Panel
#
# Linux XAMPP:
# 1. Copy this configuration to: /opt/lampp/etc/extra/httpd-vhosts.conf
#    OR add it to the end of: /opt/lampp/etc/httpd.conf
# 2. Edit the paths to match your installation
# 3. Restart Apache: sudo /opt/lampp/lampp restart

# ==========================================
# METHOD 1: Reverse Proxy Configuration
# الطريقة 1: تكوين الخادم العكسي
# ==========================================
# This method runs Flask separately and Apache proxies requests to it
# هذه الطريقة تشغل Flask بشكل منفصل و Apache يوجه الطلبات إليه

<VirtualHost *:80>
    ServerName housing.local
    ServerAlias www.housing.local
    ServerAdmin housing@imamu.edu.sa
    
    # Project directory - Windows example
    # مجلد المشروع - مثال ويندوز
    DocumentRoot "C:/xampp/htdocs/housing-system"
    
    # Project directory - Linux example (uncomment for Linux)
    # مجلد المشروع - مثال لينكس (ألغِ التعليق للينكس)
    # DocumentRoot "/opt/lampp/htdocs/housing-system"
    
    # Proxy settings to Flask application
    # إعدادات Proxy لتطبيق Flask
    ProxyPreserveHost On
    ProxyPass / http://127.0.0.1:5000/
    ProxyPassReverse / http://127.0.0.1:5000/
    
    # Timeout settings
    # إعدادات المهلة الزمنية
    ProxyTimeout 300
    TimeOut 300
    
    # Directory permissions - Windows
    # صلاحيات المجلد - ويندوز
    <Directory "C:/xampp/htdocs/housing-system">
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>
    
    # Directory permissions - Linux (uncomment for Linux)
    # صلاحيات المجلد - لينكس (ألغِ التعليق للينكس)
    # <Directory "/opt/lampp/htdocs/housing-system">
    #     Options -Indexes +FollowSymLinks
    #     AllowOverride All
    #     Require all granted
    # </Directory>
    
    # Protect sensitive files
    # حماية الملفات الحساسة
    <FilesMatch "^\.env$">
        Require all denied
    </FilesMatch>
    
    <FilesMatch "\.(db|sqlite|sqlite3)$">
        Require all denied
    </FilesMatch>
    
    # Note: In reverse proxy mode, Python files are not served by Apache
    # ملاحظة: في وضع الخادم العكسي، ملفات Python لا يتم تقديمها بواسطة Apache
    # This rule provides extra protection if reverse proxy is misconfigured
    # هذه القاعدة توفر حماية إضافية إذا كان الخادم العكسي غير مهيأ بشكل صحيح
    <FilesMatch "\.py$">
        Require all denied
    </FilesMatch>
    
    # Allow static files
    # السماح بالملفات الثابتة
    <FilesMatch "\.(css|js|png|jpg|jpeg|gif|svg|ico|woff|woff2|ttf|eot)$">
        Require all granted
    </FilesMatch>
    
    # Logging
    # تسجيل السجلات
    ErrorLog "logs/housing-error.log"
    CustomLog "logs/housing-access.log" combined
    
    # Security headers
    # ترويسات الأمان
    <IfModule mod_headers.c>
        Header set X-Content-Type-Options "nosniff"
        Header set X-Frame-Options "SAMEORIGIN"
        Header set X-XSS-Protection "1; mode=block"
        Header set Referrer-Policy "strict-origin-when-cross-origin"
    </IfModule>
</VirtualHost>


# ==========================================
# METHOD 2: mod_wsgi Configuration
# الطريقة 2: تكوين mod_wsgi
# ==========================================
# This method runs Flask directly in Apache using mod_wsgi
# هذه الطريقة تشغل Flask مباشرة في Apache باستخدام mod_wsgi
# NOTE: Requires mod_wsgi to be installed and enabled
# ملاحظة: يتطلب تثبيت وتفعيل mod_wsgi

# Uncomment the following configuration if using mod_wsgi
# ألغِ التعليق عن التكوين التالي إذا كنت تستخدم mod_wsgi

# <VirtualHost *:80>
#     ServerName housing.local
#     ServerAlias www.housing.local
#     ServerAdmin housing@imamu.edu.sa
#     
#     # Project directory - Windows
#     DocumentRoot "C:/xampp/htdocs/housing-system"
#     
#     # Project directory - Linux
#     # DocumentRoot "/opt/lampp/htdocs/housing-system"
#     
#     # WSGI Configuration - Windows
#     WSGIScriptAlias / "C:/xampp/htdocs/housing-system/housing.wsgi"
#     WSGIDaemonProcess housing python-home="C:/Python311" python-path="C:/xampp/htdocs/housing-system"
#     WSGIProcessGroup housing
#     
#     # WSGI Configuration - Linux
#     # WSGIScriptAlias / "/opt/lampp/htdocs/housing-system/housing.wsgi"
#     # WSGIDaemonProcess housing python-home="/usr" python-path="/opt/lampp/htdocs/housing-system"
#     # WSGIProcessGroup housing
#     
#     # Directory permissions - Windows
#     <Directory "C:/xampp/htdocs/housing-system">
#         WSGIApplicationGroup %{GLOBAL}
#         Options -Indexes +FollowSymLinks
#         AllowOverride All
#         Require all granted
#     </Directory>
#     
#     # Directory permissions - Linux
#     # <Directory "/opt/lampp/htdocs/housing-system">
#     #     WSGIApplicationGroup %{GLOBAL}
#     #     Options -Indexes +FollowSymLinks
#     #     AllowOverride All
#     #     Require all granted
#     # </Directory>
#     
#     # Protect sensitive files
#     <FilesMatch "^\.env$">
#         Require all denied
#     </FilesMatch>
#     
#     <FilesMatch "\.(db|sqlite|sqlite3)$">
#         Require all denied
#     </FilesMatch>
#     
#     # Logging
#     ErrorLog "logs/housing-error.log"
#     CustomLog "logs/housing-access.log" combined
# </VirtualHost>


# ==========================================
# HTTPS Configuration (Optional but Recommended)
# تكوين HTTPS (اختياري لكن موصى به)
# ==========================================
# Uncomment and configure for HTTPS support
# ألغِ التعليق وأعد التكوين لدعم HTTPS

# <VirtualHost *:443>
#     ServerName housing.local
#     ServerAlias www.housing.local
#     ServerAdmin housing@imamu.edu.sa
#     
#     # SSL Configuration
#     SSLEngine on
#     SSLCertificateFile "conf/ssl.crt/server.crt"
#     SSLCertificateKeyFile "conf/ssl.key/server.key"
#     
#     # Project directory
#     DocumentRoot "C:/xampp/htdocs/housing-system"
#     
#     # Proxy settings
#     ProxyPreserveHost On
#     ProxyPass / http://127.0.0.1:5000/
#     ProxyPassReverse / http://127.0.0.1:5000/
#     
#     # Directory permissions
#     <Directory "C:/xampp/htdocs/housing-system">
#         Options -Indexes +FollowSymLinks
#         AllowOverride All
#         Require all granted
#     </Directory>
#     
#     # Security headers
#     <IfModule mod_headers.c>
#         Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains"
#         Header set X-Content-Type-Options "nosniff"
#         Header set X-Frame-Options "SAMEORIGIN"
#         Header set X-XSS-Protection "1; mode=block"
#     </IfModule>
#     
#     ErrorLog "logs/housing-error-ssl.log"
#     CustomLog "logs/housing-access-ssl.log" combined
# </VirtualHost>


# ==========================================
# Required Apache Modules
# الوحدات المطلوبة في Apache
# ==========================================
# Make sure these modules are enabled in httpd.conf:
# تأكد من تفعيل هذه الوحدات في httpd.conf:
#
# For Reverse Proxy (Method 1):
# LoadModule proxy_module modules/mod_proxy.so
# LoadModule proxy_http_module modules/mod_proxy_http.so
# LoadModule rewrite_module modules/mod_rewrite.so
# LoadModule headers_module modules/mod_headers.so
#
# For mod_wsgi (Method 2):
# LoadModule wsgi_module modules/mod_wsgi.so
#
# For HTTPS:
# LoadModule ssl_module modules/mod_ssl.so

# ==========================================
# Hosts File Configuration
# تكوين ملف Hosts
# ==========================================
# Add the following line to your hosts file:
# أضف السطر التالي إلى ملف hosts:
#
# Windows: C:\Windows\System32\drivers\etc\hosts
# Linux: /etc/hosts
#
# 127.0.0.1    housing.local
